# 📄 Vulnerability Report - WebGoat

## 🔍 Εντοπισμένα Alerts

| Severity | Είδος Ευπάθειας     | Αρχείο                          | Περιγραφή                                      | Link στο CVE |
|----------|---------------------|----------------------------------|------------------------------------------------|----------------|
| Critical | [1] XML External Entity Injection  | src/main/java/org/owasp/webgoat/lessons/xxe/CommentsCache.java | Επιτρέπει την επίλυση εξωτερικών XML οντοτήτων σε δεδομένα που ελέγχονται από τον χρήστη | [Alert](#)    |
| Critical | [2] Deserialization of user-controlled data   | src/main/java/org/owasp/webgoat/lessons/vulnerablecomponents/VulnerableComponentsLesson.java     | Αποδέχεται και επεξεργάζεται δεδομένα που ελέγχονται από τον χρήστη | [Alert](#)     |
| Critical | [3] Deserialization of user-controlled data   | src/main/java/org/owasp/webgoat/lessons/deserialization/InsecureDeserializationTask.java         | *Ίδια ευπάθεια με την προηγούμενη | [Alert](#)     |
| Critical | [4] Server-Side Request Forgery   | src/main/java/org/owasp/webgoat/lessons/ssrf/SSRFTask2.java     | Επιτρέπει σε έναν επιτιθέμενο να υποβάλει HTTP αιτήματα προς τοπικούς ή εξωτερικούς πόρους του διακομιστή από τον οποίο εκτελείται η εφαρμογή. | [Alert](#)     |
| High     | [5] Missing JWT signature check      | src/test/java/org/owasp/webgoat/lessons/jwt/TokenTest.java   | Δεν ελέγχει την υπογραφή ενός JSON Web Token (JWT). | [Alert](#)     |
| High     | [6] Insecure randomness | src/main/java/org/owasp/webgoat/lessons/jwt/JWTRefreshEndpoint.java          | Χρησιμοποιεί αδύναμους μηχανισμούς για την παραγωγή τυχαίων αριθμών | [Alert](#)     |
| High     | [7] Query built from user-controlled sources | src/main/java/org/owasp/webgoat/lessons/sqlinjection/mitigation/Servers.java        | Δημιουργεί SQL queries χρησιμοποιώντας δεδομένα που παρέχονται από τον χρήστη χωρίς κατάλληλο έλεγχο.     | [Alert](#)     |

---  

## 🛡️ **Προτεινόμενα Μέτρα Αντιμετώπισης**

### [1] **XML External Entity (XXE) Injection**
- **Απενεργοποίηση Doctype και εξωτερικών οντοτήτων XML:** Σιγουρευτείτε ότι ο XML parser δεν επιτρέπει την εισαγωγή εξωτερικών οντοτήτων. Μειώνεται η δυνατότητα εκμετάλλευσης.
- **Χρήση ασφαλών XML parsers:** Προτίμηση ασφαλών παραμετροποιημένων parsers (π.χ. `DocumentBuilderFactory`) που αποτρέπουν την εκτέλεση επιθέσεων XXE.
- **Αποφυγή της χρήσης XML όταν είναι δυνατόν:** Όπου είναι δυνατό, χρησιμοποιήστε πιο ασφαλή δεδομένα τύπου JSON αντί XML.

### [2] **Deserialization of user-controlled data**
- **Αποφυγή deserialization από μη αξιόπιστες πηγές:** Μην αποδέχεστε serialized δεδομένα από μη αξιόπιστους χρήστες ή ανεξέλεγκτες πηγές.
- **Επιβολή ελέγχου τύπου κατά τη deserialization:** Βεβαιωθείτε ότι τα αντικείμενα που ανακτώνται είναι του σωστού τύπου πριν τα χρησιμοποιήσετε.
- **Χρήση ασφαλών αντικειμένων για serialization:** Προτίμηση σε πιο ασφαλή formats όπως JSON ή XML, ή αντικείμενα που δεν έχουν επικίνδυνες δυνατότητες για deserialization.

### [3] **Server-Side Request Forgery (SSRF)**
- **Φιλτράρισμα και έλεγχος URLs:** Ελέγξτε τα URLs που εισάγονται από τον χρήστη και απορρίψτε οποιαδήποτε αιτήματα προς τοπικές διευθύνσεις.
- **Περιορισμός πρόσβασης σε εσωτερικές υπηρεσίες:** Αποτρέψτε τις αιτήσεις προς εσωτερικούς διακομιστές ή τοπικά δίκτυα (π.χ. μέσω firewall ή proxy).

### [4] **Missing JWT signature check**
- **Επαλήθευση υπογραφής JWT:** Βεβαιωθείτε ότι κάθε JWT που λαμβάνεται έχει έγκυρη υπογραφή πριν να το χρησιμοποιήσετε.
- **Χρήση ισχυρών αλγορίθμων υπογραφής:** Προτιμήστε αλγορίθμους όπως `RS256` ή `HS256` για την υπογραφή των JWT tokens.

### [5] **Insecure randomness**
- **Χρήση κρυπτογραφικά ασφαλών γεννητριών τυχαίων αριθμών:** Αντί για τη χρήση της `Math.random()`, χρησιμοποιήστε ασφαλείς αλγορίθμους όπως `SecureRandom`.
- **Επαλήθευση της ποιότητας της τυχαιότητας:** Βεβαιωθείτε ότι οι τυχαίοι αριθμοί ή κλειδιά που παράγονται είναι επαρκώς τυχαία και ασφαλή.
- **Περιορισμός της χρήσης εύκολων να προβλεφθούν αριθμών:** Μην χρησιμοποιείτε εύκολα προβλέψιμα τυχαία δεδομένα για την ασφάλεια ή τον έλεγχο ταυτότητας.

### [6] **Query built from user-controlled sources**
- **Χρήση Prepared Statements για αποφυγή SQL Injection:** Αντί για την απευθείας εισαγωγή των δεδομένων χρηστών σε SQL queries, χρησιμοποιήστε `Prepared Statements`.
- **Επαλήθευση της μορφής και τύπου των δεδομένων:** Βεβαιωθείτε ότι τα δεδομένα από τον χρήστη έχουν περάσει από έλεγχο τύπου ή validation πριν να χρησιμοποιηθούν σε οποιοδήποτε query.

  ---

## 🔁 Κατάσταση μετά τη Διόρθωση

| Ευπάθεια | Κατάσταση | Σχόλιο |
|----------|-----------|--------|
| [1] XML External Entity Injection | ✅ Fixed | Προστέθηκαν ρυθμίσεις για απενεργοποίηση εξωτερικών DTD & οντοτήτων. |
| [2] Deserialization of user-controlled data | ✅ Fixed | Εφαρμόστηκε whitelist-based deserialization για να επιτρέπονται μόνο γνωστές κλάσεις και αγνοούνται άγνωστα δεδομένα. |
| [3] Deserialization of user-controlled data | ✅ Fixed |  Αντικαταστάθηκε το `ObjectInputStream` με JSON deserialization. |
| [4] Server-Side Request Forgery | ✅ Fixed | Εφαρμόστηκε whitelist validation για URLs και χρήση ασφαλούς HTTP client. |
| [5] Missing JWT signature check | ✅ Fixed | Προστέθηκε έλεγχος υπογραφής με `parseClaimsJws()`. |
| [6]  Insecure randomness | ✅ Fixed | Αντικαταστάθηκε η `RandomStringUtils` με `SecureRandom` για ασφαλή δημιουργία tokens. |
| [7] Query built from user-controlled sources | ✅ Fixed | Προστέθηκε whitelist validation για την παράμετρο `column`. |

---

